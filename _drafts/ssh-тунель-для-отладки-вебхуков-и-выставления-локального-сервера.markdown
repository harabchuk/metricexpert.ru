---
layout: "post"
title: "SSH тунель для отладки вебхуков и выставления локального сервера"
date: "2017-04-25 20:20"
---

В Sipuni я работаю над интеграцией телефонии с CRM. Почти все CRM требуют внешний адрес для
передачи событий – вебхуки. Для отладки работы вебхуков подойдет описанный ниже способ.

**Проблема**: нужно сделать локальный сервер доступным из интернет, чтобы подать его адрес в качестве вебхука,
и получать события от CRM или другого сервиса, который вы отлаживаете.

**Возможные решения**: использовать сервис ngrok и другие похожие на него или настроить SSH тунель.
Второй способ подходит, если у вас уже есть сервер и к нему есть доступ по SSH.

### Быстрый способ проверить SSH тунель

TODO: Проверить опцию GatewayPorts yes в ~/.ssh/config

### Автоподключение SSH тунеля при разрыве соединения

Самое неприятное, когда SSH тоннель теряет соединение. Тоннель просто перестает работать. При попытке
переподключиться, может появится ошибка, о том что порт занят. Вобщем, неудобно. К счастью есть autossh, программа,
которая следит за соединение, и восстанавливает его. При этом пользоваться ей не сложнее, чем запустить сам тоннель.

### Выводы

При помощи autossh соединение получилось стабильным, работает даже при выходе компьютера из сна.
Решение бесплатное при условии, что уже есть сервер.
